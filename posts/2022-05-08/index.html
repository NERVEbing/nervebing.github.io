<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>基于HPE MicroServer Gen10 Plus的HomeLab搭建 - 硬件篇 | LvLv's Blog.</title><meta name=keywords content="HomeLab,设备"><meta name=description content="前言 声明 本文是个人对HomeLab即家庭私有实验室的学习探索，参杂着一些经验总结，记录下来，也希望可以让他人少走一些弯路。
HomeLab是什么？ 本质上是一个连接各种设备的复杂系统，你可以用任何树莓派/PC/服务器/路由器组成一个HomeLab。
HomeLab有什么用？  搭建属于私人的网盘，不必在各个设备上安装云盘app才能上传/下载文件 不受版权控制的家庭多媒体，集成影视订阅，实现观影追剧自由 集成HomeBridge以实现在iOS/macOS的Home.app中操作非HomeKit认证的设备 BT下载器，无需开启个人电脑，后台下载资源 RSS订阅器，抛弃无意义地刷手机，只获取自己想要的内容 bilibili每日任务/JD京豆获取，各种脚本反薅资本家的羊毛 最重要的是你可以搭建包括但不限于K8S/ELK/MySQL/Redis/Prometheus等各种服务，也可以在上面跑CI/CD自动化构建发布你的代码  阅读门槛  基本的网络知识，比如光猫和路由器的区别，交换机是干什么的 基本的Linux操作，可以理解计算机不是一定要连接显示器才可以操作 遇到问题先使用英文进行Google，内容过长可以开启页面翻译，请不要看CSDN的内容 不求甚解，当你发现你让它跑起来了的时候，会获得极大的心理满足感  设备 架构说明 主要分为服务器和网络设备。考虑到网络设备的稳定性及网络隔离对整套系统的重要程度，没有采用虚拟化AIO(ALL IN ONE)方案。
作为服务端开发者看来所谓的AIO毫无稳定性可言，ESXi的OpenWrt虚拟机出了故障会影响其他业务虚拟机的运行，甚至连iLO后台都进不去，需要连接显示器手动配置ESXi进行修复，这种情况在异地操作HomeLab节点的时候是毁灭性的灾难。
当然这种方式的好处也有：网上教程多，按视频操作一步步做几乎没有难点，小白也能轻松搭建。
缺点就是对整体的HomeLab环境一知半解甚至根本不懂，只会复制粘贴。当然你可以说“我只是想快速搭建一整套服务，不想了解细节”，这样的话本文可能不适合你。
服务器 首先是最重要的服务器部分，绝大多数设备购入时间为2021年2-3月，价格相比当前可能有很大差距，费用清单如下：
   设备 价格(元) 数量 备注     HPE Gen10 Plus G5420/8GB 4000 1 淘宝/德国转运   iLO5 NIC Kit 399 1 同上   Intel 志强 E-2146G 1400 1 淘宝/QS版   海力士 32GB DDR4 2666MHz ECC 2600 2 淘宝   希捷 Exos X18 16TB 4200 2 淘宝/国行   英睿达 MX500 SATA SSD 2TB 2400 2 京东自营   三星 PM991 256GB + 佳翼硬盘盒 300 1 PM991闲鱼/硬盘盒京东   三星 850PRO SATA SSD 256G 0 2 家用闲置   Intel 傲腾 NVMe SSD 16GB 0 2 家用闲置   Intel 奔腾 G5420 -488 1 闲鱼出了   HPE 原装海力士 8GB ECC -300 1 闲鱼出了   盈通 GTX1650 4GB DDR6 85 1 1535购入/1450出了   佳翼 NVMe 4X4 阵列卡 1200 1 淘宝   总计 15796      之前没怎么认真统计花费，看到总计后还是惊了一下，老实说这个价格可以上塔式服务器或者洋垃圾DIY。选择Gen10 Plus的理由无外乎精致/美观/静音，毕竟这是一台可以放在卧室的服务器。"><meta name=author content="L"><link rel=canonical href=https://blog.lvlv.fun/posts/2022-05-08/><link crossorigin=anonymous href=/assets/css/stylesheet.min.45fdfa50104cd4e8762cefccb5ad33dd6cbaef5c109d72d25b1c27d6a21d00eb.css integrity="sha256-Rf36UBBM1Oh2LO/Mta0z3Wy671wQnXLSWxwn1qIdAOs=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.lvlv.fun/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.lvlv.fun/favicon16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.lvlv.fun/favicon32x32.png><link rel=apple-touch-icon href=https://blog.lvlv.fun/apple_touch_icon.png><link rel=mask-icon href=https://blog.lvlv.fun/apple_touch_icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src=https://unpkg.com/@waline/client@v2/dist/waline.js></script>
<link rel=stylesheet href=https://unpkg.com/@waline/client@v2/dist/waline.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-PQC91FX0L3"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PQC91FX0L3",{anonymize_ip:!1})}</script><meta property="og:title" content="基于HPE MicroServer Gen10 Plus的HomeLab搭建 - 硬件篇"><meta property="og:description" content="前言 声明 本文是个人对HomeLab即家庭私有实验室的学习探索，参杂着一些经验总结，记录下来，也希望可以让他人少走一些弯路。
HomeLab是什么？ 本质上是一个连接各种设备的复杂系统，你可以用任何树莓派/PC/服务器/路由器组成一个HomeLab。
HomeLab有什么用？  搭建属于私人的网盘，不必在各个设备上安装云盘app才能上传/下载文件 不受版权控制的家庭多媒体，集成影视订阅，实现观影追剧自由 集成HomeBridge以实现在iOS/macOS的Home.app中操作非HomeKit认证的设备 BT下载器，无需开启个人电脑，后台下载资源 RSS订阅器，抛弃无意义地刷手机，只获取自己想要的内容 bilibili每日任务/JD京豆获取，各种脚本反薅资本家的羊毛 最重要的是你可以搭建包括但不限于K8S/ELK/MySQL/Redis/Prometheus等各种服务，也可以在上面跑CI/CD自动化构建发布你的代码  阅读门槛  基本的网络知识，比如光猫和路由器的区别，交换机是干什么的 基本的Linux操作，可以理解计算机不是一定要连接显示器才可以操作 遇到问题先使用英文进行Google，内容过长可以开启页面翻译，请不要看CSDN的内容 不求甚解，当你发现你让它跑起来了的时候，会获得极大的心理满足感  设备 架构说明 主要分为服务器和网络设备。考虑到网络设备的稳定性及网络隔离对整套系统的重要程度，没有采用虚拟化AIO(ALL IN ONE)方案。
作为服务端开发者看来所谓的AIO毫无稳定性可言，ESXi的OpenWrt虚拟机出了故障会影响其他业务虚拟机的运行，甚至连iLO后台都进不去，需要连接显示器手动配置ESXi进行修复，这种情况在异地操作HomeLab节点的时候是毁灭性的灾难。
当然这种方式的好处也有：网上教程多，按视频操作一步步做几乎没有难点，小白也能轻松搭建。
缺点就是对整体的HomeLab环境一知半解甚至根本不懂，只会复制粘贴。当然你可以说“我只是想快速搭建一整套服务，不想了解细节”，这样的话本文可能不适合你。
服务器 首先是最重要的服务器部分，绝大多数设备购入时间为2021年2-3月，价格相比当前可能有很大差距，费用清单如下：
   设备 价格(元) 数量 备注     HPE Gen10 Plus G5420/8GB 4000 1 淘宝/德国转运   iLO5 NIC Kit 399 1 同上   Intel 志强 E-2146G 1400 1 淘宝/QS版   海力士 32GB DDR4 2666MHz ECC 2600 2 淘宝   希捷 Exos X18 16TB 4200 2 淘宝/国行   英睿达 MX500 SATA SSD 2TB 2400 2 京东自营   三星 PM991 256GB + 佳翼硬盘盒 300 1 PM991闲鱼/硬盘盒京东   三星 850PRO SATA SSD 256G 0 2 家用闲置   Intel 傲腾 NVMe SSD 16GB 0 2 家用闲置   Intel 奔腾 G5420 -488 1 闲鱼出了   HPE 原装海力士 8GB ECC -300 1 闲鱼出了   盈通 GTX1650 4GB DDR6 85 1 1535购入/1450出了   佳翼 NVMe 4X4 阵列卡 1200 1 淘宝   总计 15796      之前没怎么认真统计花费，看到总计后还是惊了一下，老实说这个价格可以上塔式服务器或者洋垃圾DIY。选择Gen10 Plus的理由无外乎精致/美观/静音，毕竟这是一台可以放在卧室的服务器。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.lvlv.fun/posts/2022-05-08/"><meta property="og:image" content="https://pic.lvlv.fun/img/blog/Gen10P-1.jpg?x-oss-process=style/jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-08T11:09:36+08:00"><meta property="article:modified_time" content="2022-05-08T11:09:36+08:00"><meta property="og:site_name" content="LvLv's Blog."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pic.lvlv.fun/img/blog/Gen10P-1.jpg?x-oss-process=style/jpg"><meta name=twitter:title content="基于HPE MicroServer Gen10 Plus的HomeLab搭建 - 硬件篇"><meta name=twitter:description content="前言 声明 本文是个人对HomeLab即家庭私有实验室的学习探索，参杂着一些经验总结，记录下来，也希望可以让他人少走一些弯路。
HomeLab是什么？ 本质上是一个连接各种设备的复杂系统，你可以用任何树莓派/PC/服务器/路由器组成一个HomeLab。
HomeLab有什么用？  搭建属于私人的网盘，不必在各个设备上安装云盘app才能上传/下载文件 不受版权控制的家庭多媒体，集成影视订阅，实现观影追剧自由 集成HomeBridge以实现在iOS/macOS的Home.app中操作非HomeKit认证的设备 BT下载器，无需开启个人电脑，后台下载资源 RSS订阅器，抛弃无意义地刷手机，只获取自己想要的内容 bilibili每日任务/JD京豆获取，各种脚本反薅资本家的羊毛 最重要的是你可以搭建包括但不限于K8S/ELK/MySQL/Redis/Prometheus等各种服务，也可以在上面跑CI/CD自动化构建发布你的代码  阅读门槛  基本的网络知识，比如光猫和路由器的区别，交换机是干什么的 基本的Linux操作，可以理解计算机不是一定要连接显示器才可以操作 遇到问题先使用英文进行Google，内容过长可以开启页面翻译，请不要看CSDN的内容 不求甚解，当你发现你让它跑起来了的时候，会获得极大的心理满足感  设备 架构说明 主要分为服务器和网络设备。考虑到网络设备的稳定性及网络隔离对整套系统的重要程度，没有采用虚拟化AIO(ALL IN ONE)方案。
作为服务端开发者看来所谓的AIO毫无稳定性可言，ESXi的OpenWrt虚拟机出了故障会影响其他业务虚拟机的运行，甚至连iLO后台都进不去，需要连接显示器手动配置ESXi进行修复，这种情况在异地操作HomeLab节点的时候是毁灭性的灾难。
当然这种方式的好处也有：网上教程多，按视频操作一步步做几乎没有难点，小白也能轻松搭建。
缺点就是对整体的HomeLab环境一知半解甚至根本不懂，只会复制粘贴。当然你可以说“我只是想快速搭建一整套服务，不想了解细节”，这样的话本文可能不适合你。
服务器 首先是最重要的服务器部分，绝大多数设备购入时间为2021年2-3月，价格相比当前可能有很大差距，费用清单如下：
   设备 价格(元) 数量 备注     HPE Gen10 Plus G5420/8GB 4000 1 淘宝/德国转运   iLO5 NIC Kit 399 1 同上   Intel 志强 E-2146G 1400 1 淘宝/QS版   海力士 32GB DDR4 2666MHz ECC 2600 2 淘宝   希捷 Exos X18 16TB 4200 2 淘宝/国行   英睿达 MX500 SATA SSD 2TB 2400 2 京东自营   三星 PM991 256GB + 佳翼硬盘盒 300 1 PM991闲鱼/硬盘盒京东   三星 850PRO SATA SSD 256G 0 2 家用闲置   Intel 傲腾 NVMe SSD 16GB 0 2 家用闲置   Intel 奔腾 G5420 -488 1 闲鱼出了   HPE 原装海力士 8GB ECC -300 1 闲鱼出了   盈通 GTX1650 4GB DDR6 85 1 1535购入/1450出了   佳翼 NVMe 4X4 阵列卡 1200 1 淘宝   总计 15796      之前没怎么认真统计花费，看到总计后还是惊了一下，老实说这个价格可以上塔式服务器或者洋垃圾DIY。选择Gen10 Plus的理由无外乎精致/美观/静音，毕竟这是一台可以放在卧室的服务器。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.lvlv.fun/posts/"},{"@type":"ListItem","position":2,"name":"基于HPE MicroServer Gen10 Plus的HomeLab搭建 - 硬件篇","item":"https://blog.lvlv.fun/posts/2022-05-08/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"基于HPE MicroServer Gen10 Plus的HomeLab搭建 - 硬件篇","name":"基于HPE MicroServer Gen10 Plus的HomeLab搭建 - 硬件篇","description":"前言 声明 本文是个人对HomeLab即家庭私有实验室的学习探索，参杂着一些经验总结，记录下来，也希望可以让他人少走一些弯路。\nHomeLab是什么？ 本质上是一个连接各种设备的复杂系统，你可以用任何树莓派/PC/服务器/路由器组成一个HomeLab。\nHomeLab有什么用？  搭建属于私人的网盘，不必在各个设备上安装云盘app才能上传/下载文件 不受版权控制的家庭多媒体，集成影视订阅，实现观影追剧自由 集成HomeBridge以实现在iOS/macOS的Home.app中操作非HomeKit认证的设备 BT下载器，无需开启个人电脑，后台下载资源 RSS订阅器，抛弃无意义地刷手机，只获取自己想要的内容 bilibili每日任务/JD京豆获取，各种脚本反薅资本家的羊毛 最重要的是你可以搭建包括但不限于K8S/ELK/MySQL/Redis/Prometheus等各种服务，也可以在上面跑CI/CD自动化构建发布你的代码  阅读门槛  基本的网络知识，比如光猫和路由器的区别，交换机是干什么的 基本的Linux操作，可以理解计算机不是一定要连接显示器才可以操作 遇到问题先使用英文进行Google，内容过长可以开启页面翻译，请不要看CSDN的内容 不求甚解，当你发现你让它跑起来了的时候，会获得极大的心理满足感  设备 架构说明 主要分为服务器和网络设备。考虑到网络设备的稳定性及网络隔离对整套系统的重要程度，没有采用虚拟化AIO(ALL IN ONE)方案。\n作为服务端开发者看来所谓的AIO毫无稳定性可言，ESXi的OpenWrt虚拟机出了故障会影响其他业务虚拟机的运行，甚至连iLO后台都进不去，需要连接显示器手动配置ESXi进行修复，这种情况在异地操作HomeLab节点的时候是毁灭性的灾难。\n当然这种方式的好处也有：网上教程多，按视频操作一步步做几乎没有难点，小白也能轻松搭建。\n缺点就是对整体的HomeLab环境一知半解甚至根本不懂，只会复制粘贴。当然你可以说“我只是想快速搭建一整套服务，不想了解细节”，这样的话本文可能不适合你。\n服务器 首先是最重要的服务器部分，绝大多数设备购入时间为2021年2-3月，价格相比当前可能有很大差距，费用清单如下：\n   设备 价格(元) 数量 备注     HPE Gen10 Plus G5420/8GB 4000 1 淘宝/德国转运   iLO5 NIC Kit 399 1 同上   Intel 志强 E-2146G 1400 1 淘宝/QS版   海力士 32GB DDR4 2666MHz ECC 2600 2 淘宝   希捷 Exos X18 16TB 4200 2 淘宝/国行   英睿达 MX500 SATA SSD 2TB 2400 2 京东自营   三星 PM991 256GB + 佳翼硬盘盒 300 1 PM991闲鱼/硬盘盒京东   三星 850PRO SATA SSD 256G 0 2 家用闲置   Intel 傲腾 NVMe SSD 16GB 0 2 家用闲置   Intel 奔腾 G5420 -488 1 闲鱼出了   HPE 原装海力士 8GB ECC -300 1 闲鱼出了   盈通 GTX1650 4GB DDR6 85 1 1535购入/1450出了   佳翼 NVMe 4X4 阵列卡 1200 1 淘宝   总计 15796      之前没怎么认真统计花费，看到总计后还是惊了一下，老实说这个价格可以上塔式服务器或者洋垃圾DIY。选择Gen10 Plus的理由无外乎精致/美观/静音，毕竟这是一台可以放在卧室的服务器。","keywords":["HomeLab","设备"],"articleBody":"前言 声明 本文是个人对HomeLab即家庭私有实验室的学习探索，参杂着一些经验总结，记录下来，也希望可以让他人少走一些弯路。\nHomeLab是什么？ 本质上是一个连接各种设备的复杂系统，你可以用任何树莓派/PC/服务器/路由器组成一个HomeLab。\nHomeLab有什么用？  搭建属于私人的网盘，不必在各个设备上安装云盘app才能上传/下载文件 不受版权控制的家庭多媒体，集成影视订阅，实现观影追剧自由 集成HomeBridge以实现在iOS/macOS的Home.app中操作非HomeKit认证的设备 BT下载器，无需开启个人电脑，后台下载资源 RSS订阅器，抛弃无意义地刷手机，只获取自己想要的内容 bilibili每日任务/JD京豆获取，各种脚本反薅资本家的羊毛 最重要的是你可以搭建包括但不限于K8S/ELK/MySQL/Redis/Prometheus等各种服务，也可以在上面跑CI/CD自动化构建发布你的代码  阅读门槛  基本的网络知识，比如光猫和路由器的区别，交换机是干什么的 基本的Linux操作，可以理解计算机不是一定要连接显示器才可以操作 遇到问题先使用英文进行Google，内容过长可以开启页面翻译，请不要看CSDN的内容 不求甚解，当你发现你让它跑起来了的时候，会获得极大的心理满足感  设备 架构说明 主要分为服务器和网络设备。考虑到网络设备的稳定性及网络隔离对整套系统的重要程度，没有采用虚拟化AIO(ALL IN ONE)方案。\n作为服务端开发者看来所谓的AIO毫无稳定性可言，ESXi的OpenWrt虚拟机出了故障会影响其他业务虚拟机的运行，甚至连iLO后台都进不去，需要连接显示器手动配置ESXi进行修复，这种情况在异地操作HomeLab节点的时候是毁灭性的灾难。\n当然这种方式的好处也有：网上教程多，按视频操作一步步做几乎没有难点，小白也能轻松搭建。\n缺点就是对整体的HomeLab环境一知半解甚至根本不懂，只会复制粘贴。当然你可以说“我只是想快速搭建一整套服务，不想了解细节”，这样的话本文可能不适合你。\n服务器 首先是最重要的服务器部分，绝大多数设备购入时间为2021年2-3月，价格相比当前可能有很大差距，费用清单如下：\n   设备 价格(元) 数量 备注     HPE Gen10 Plus G5420/8GB 4000 1 淘宝/德国转运   iLO5 NIC Kit 399 1 同上   Intel 志强 E-2146G 1400 1 淘宝/QS版   海力士 32GB DDR4 2666MHz ECC 2600 2 淘宝   希捷 Exos X18 16TB 4200 2 淘宝/国行   英睿达 MX500 SATA SSD 2TB 2400 2 京东自营   三星 PM991 256GB + 佳翼硬盘盒 300 1 PM991闲鱼/硬盘盒京东   三星 850PRO SATA SSD 256G 0 2 家用闲置   Intel 傲腾 NVMe SSD 16GB 0 2 家用闲置   Intel 奔腾 G5420 -488 1 闲鱼出了   HPE 原装海力士 8GB ECC -300 1 闲鱼出了   盈通 GTX1650 4GB DDR6 85 1 1535购入/1450出了   佳翼 NVMe 4X4 阵列卡 1200 1 淘宝   总计 15796      之前没怎么认真统计花费，看到总计后还是惊了一下，老实说这个价格可以上塔式服务器或者洋垃圾DIY。选择Gen10 Plus的理由无外乎精致/美观/静音，毕竟这是一台可以放在卧室的服务器。\n总的来说硬盘/存储占比重较大，当前情况下的配置不是最终配置，目的也仅仅是为了满足个人需求。\n如果能把硬盘换成SATA SSD 4TB * 4会更好，当然NVMe阵列卡插满4条m.2也可，主做NAS服务器的话直接更换为10G/25G/40G网卡。配置是为了匹配实际用途，否则就是卑鄙的浪费。\n主机 主机从下单到收货前前后后差不多一个月的时间。 开箱，高贵的日耳曼甜美空气扑面而来(doge)。\n即使在公司加班也阻止不了我欣赏它的美。\n拧开快拆螺丝，欣赏大厂的工整做工，简直是一件艺术品。\nCPU 首先我们要知道Gen10 Plus的DC电源是180W，在官方高配也就是Intel志强E-2224/16GB/单SSD的情况下整机功耗能达到110W，最多只能留下70W的可用空间。考虑到电源转换效率以及需要留点余量(20W)，这样我们可以操作的空间就只剩下50W。\n每一块希捷 Exos X18 16TB的待机功耗大概是5W，满载功耗是10W，4块满载40W，这么看来光是硬盘塞满的情况下电源就已经快撑不住了，更别提上个网卡或显卡了。\n然而事实是我们不会让服务器始终跑在100%的负载下，也就是说功耗峰值不代表日常功耗。根据我目前的配置，待机功耗在35W左右，目前跑了20+个服务的情况下也不过50W，程序的CPU占用率也可以在docker命令中加以限制。\n现在我们再来看CPU的选择：\n 上图来自servethehome.com的HPE ProLiant MicroServer Gen10 Plus Ultimate Customization Guide一文，是一篇非常好的HPE Gen10 Plus设备选择指导。\n 根据servethehome.com的测试结果，当使用E-2288G/64GB/单SSD在Windows Server 2019上跑Prime95时，功率计上的数值达到了194.5W，所以8核16线程直接排除。\n由于跑大量服务需要更多的核心/线程数，并且官方高配就是4核4线程，所以我们筛选6核12线程的CPU如下：\n   型号 核心/线程数 频率 TDP(W)     基准 E-2224 4C/4T 3.4-4.6GHz 71W   E-2276G 6C/12T 3.8-4.9GHz 80W   E-2246G 6C/12T 3.6-4.8GHz 80W   E-2236 6C/12T 3.4-4.8GHz 80W   E-2176G 6C/12T 3.7-4.7GHz 80W   E-2146G 6C/12T 3.5-4.5GHz 80W   E-2136 6C/12T 3.3-4.5GHz 80W    最好的选择当然是E-2276G，但当时E-22XX系列太贵了，而且志强8代与9代性能差距不大，所以范围缩小成了E-2176G、E-2146G、E-2136三款。\n根据CPU Benchmarks的对比结果来看三款在跑分上基本上可以说是没什么差距，由于E-2146G相比E-2136多了核显，虽然Gen10 Plus主板屏蔽了核显，但以后可以等E-2278G价格亲民后进行置换，拆下来E-2146G可以给别的机器用，所以最终选择了E-2146G。\n淘宝1400拿下E-2146G QS正显，步进和正式版相同e4，成色相当之好，插上点亮。\niLO中处理器信息一切正常。\n稍微测了下，睿频4.5GHz，全核心满载4.2GHz，此时CPU温度85度左右，插座显示120W，对这个结果相当满意。\n内存 HPE Gen10 Plus官方产品页上写的最大支持内存是32GB，实测支持64GB，且不像Gen8，Gen10 Plus支持非ECC内存，给预算不充足的玩家留足了余地。\nHPE的原装内存是海力士的8GB DDR4 ECC 2666MHz，在奔腾G5420下只能以2400MHz运行，不多说直接挂闲鱼。\n32GB纯ECC内存的选择有三星和海力士。三星由于贴牌寨条较多，正品库存少不好买，海力士也是HPE认证内存厂商，所以选择了后者。\niLO内存信息，64GB DDR4 2666MHz ECC，双通道运行。\n奇怪的是制造商一栏显示不适用，但其他信息完全正常，Reddit上查到只有官方部件号的16GB单条才有制造商信息，无所谓了。\nTODO…\nPCIe 网络设备 OpenWrt Wi-Fi Mesh UPS不间断电源 其他 ","wordCount":"227","inLanguage":"zh","image":"https://pic.lvlv.fun/img/blog/Gen10P-1.jpg?x-oss-process=style/jpg","datePublished":"2022-05-08T11:09:36+08:00","dateModified":"2022-05-08T11:09:36+08:00","author":{"@type":"Person","name":"L"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.lvlv.fun/posts/2022-05-08/"},"publisher":{"@type":"Organization","name":"LvLv's Blog.","logo":{"@type":"ImageObject","url":"https://blog.lvlv.fun/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&(localStorage.clear(),document.body.classList.add("dark"))</script><header class=header><nav class=nav><div class=logo><a href=https://blog.lvlv.fun/ accesskey=h title="Home (Alt + H)"><img src=https://blog.lvlv.fun/apple-touch-icon.png alt=logo aria-label=logo height=35>Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://blog.lvlv.fun/archives/ title=归档><span>归档</span></a></li><li><a href=https://blog.lvlv.fun/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>基于HPE MicroServer Gen10 Plus的HomeLab搭建 - 硬件篇</h1><div class=post-meta><span title="2022-05-08 11:09:36 +0800 +0800">2022-05-08</span>&nbsp;·&nbsp;2 分钟&nbsp;·&nbsp;L&nbsp;|&nbsp;<a href=https://github.com/NERVEbing/blog/blob/master/content/posts/2022-05-08.md rel="noopener noreferrer" target=_blank>编辑</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e5%89%8d%e8%a8%80 aria-label=前言>前言</a><ul><li><a href=#%e5%a3%b0%e6%98%8e aria-label=声明>声明</a></li><li><a href=#homelab%e6%98%af%e4%bb%80%e4%b9%88 aria-label=HomeLab是什么？>HomeLab是什么？</a></li><li><a href=#homelab%e6%9c%89%e4%bb%80%e4%b9%88%e7%94%a8 aria-label=HomeLab有什么用？>HomeLab有什么用？</a></li><li><a href=#%e9%98%85%e8%af%bb%e9%97%a8%e6%a7%9b aria-label=阅读门槛>阅读门槛</a></li></ul></li><li><a href=#%e8%ae%be%e5%a4%87 aria-label=设备>设备</a><ul><li><a href=#%e6%9e%b6%e6%9e%84%e8%af%b4%e6%98%8e aria-label=架构说明>架构说明</a></li><li><a href=#%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label=服务器>服务器</a><ul><li><a href=#%e4%b8%bb%e6%9c%ba aria-label=主机>主机</a></li><li><a href=#cpu aria-label=CPU>CPU</a></li><li><a href=#%e5%86%85%e5%ad%98 aria-label=内存>内存</a></li><li><a href=#pcie aria-label=PCIe>PCIe</a></li></ul></li><li><a href=#%e7%bd%91%e7%bb%9c%e8%ae%be%e5%a4%87 aria-label=网络设备>网络设备</a><ul><li><a href=#openwrt aria-label=OpenWrt>OpenWrt</a></li><li><a href=#wi-fi-mesh aria-label="Wi-Fi Mesh">Wi-Fi Mesh</a></li><li><a href=#ups%e4%b8%8d%e9%97%b4%e6%96%ad%e7%94%b5%e6%ba%90 aria-label=UPS不间断电源>UPS不间断电源</a></li></ul></li><li><a href=#%e5%85%b6%e4%bb%96 aria-label=其他>其他</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h1><h2 id=声明>声明<a hidden class=anchor aria-hidden=true href=#声明>#</a></h2><p>本文是个人对<a href=https://www.seeedstudio.com/blog/2020/12/22/what-is-a-home-lab-getting-started-and-recommendations/><em><strong>HomeLab</strong></em></a>即家庭私有实验室的学习探索，参杂着一些经验总结，记录下来，也希望可以让他人少走一些弯路。</p><h2 id=homelab是什么>HomeLab是什么？<a hidden class=anchor aria-hidden=true href=#homelab是什么>#</a></h2><p>本质上是一个连接各种设备的复杂系统，你可以用任何树莓派/PC/服务器/路由器组成一个HomeLab。</p><h2 id=homelab有什么用>HomeLab有什么用？<a hidden class=anchor aria-hidden=true href=#homelab有什么用>#</a></h2><ol><li>搭建属于私人的网盘，不必在各个设备上安装云盘app才能上传/下载文件</li><li>不受版权控制的家庭多媒体，集成影视订阅，实现观影追剧自由</li><li>集成HomeBridge以实现在iOS/macOS的Home.app中操作非HomeKit认证的设备</li><li>BT下载器，无需开启个人电脑，后台下载资源</li><li>RSS订阅器，抛弃无意义地刷手机，只获取自己想要的内容</li><li>bilibili每日任务/JD京豆获取，各种脚本反薅资本家的羊毛</li><li>最重要的是你可以搭建包括但不限于K8S/ELK/MySQL/Redis/Prometheus等各种服务，也可以在上面跑CI/CD自动化构建发布你的代码</li></ol><h2 id=阅读门槛>阅读门槛<a hidden class=anchor aria-hidden=true href=#阅读门槛>#</a></h2><ol><li>基本的网络知识，比如光猫和路由器的区别，交换机是干什么的</li><li>基本的Linux操作，可以理解计算机不是一定要连接显示器才可以操作</li><li>遇到问题先使用英文进行Google，内容过长可以开启页面翻译，请不要看CSDN的内容</li><li>不求甚解，当你发现你让它跑起来了的时候，会获得极大的心理满足感</li></ol><h1 id=设备>设备<a hidden class=anchor aria-hidden=true href=#设备>#</a></h1><h2 id=架构说明>架构说明<a hidden class=anchor aria-hidden=true href=#架构说明>#</a></h2><p>主要分为服务器和网络设备。考虑到网络设备的稳定性及网络隔离对整套系统的重要程度，没有采用虚拟化<a href=https://zhuanlan.zhihu.com/p/374163378><em><strong>AIO</strong></em></a>(ALL IN ONE)方案。</p><p>作为服务端开发者看来所谓的AIO毫无稳定性可言，ESXi的OpenWrt虚拟机出了故障会影响其他业务虚拟机的运行，甚至连iLO后台都进不去，需要连接显示器手动配置ESXi进行修复，这种情况在异地操作HomeLab节点的时候是毁灭性的灾难。</p><p>当然这种方式的好处也有：<a href=https://www.bilibili.com/video/BV1GY41177Es>网上教程</a>多，按视频操作一步步做几乎没有难点，小白也能轻松搭建。</p><p>缺点就是对整体的HomeLab环境一知半解甚至根本不懂，只会复制粘贴。当然你可以说“我只是想快速搭建一整套服务，不想了解细节”，这样的话本文可能不适合你。</p><h2 id=服务器>服务器<a hidden class=anchor aria-hidden=true href=#服务器>#</a></h2><p>首先是最重要的服务器部分，绝大多数设备购入时间为<strong>2021年2-3月</strong>，价格相比当前可能有很大差距，费用清单如下：</p><table><thead><tr><th>设备</th><th>价格(元)</th><th>数量</th><th>备注</th></tr></thead><tbody><tr><td>HPE Gen10 Plus G5420/8GB</td><td>4000</td><td>1</td><td>淘宝/德国转运</td></tr><tr><td>iLO5 NIC Kit</td><td>399</td><td>1</td><td>同上</td></tr><tr><td>Intel 志强 E-2146G</td><td>1400</td><td>1</td><td>淘宝/QS版</td></tr><tr><td>海力士 32GB DDR4 2666MHz ECC</td><td>2600</td><td>2</td><td>淘宝</td></tr><tr><td>希捷 Exos X18 16TB</td><td>4200</td><td>2</td><td>淘宝/国行</td></tr><tr><td>英睿达 MX500 SATA SSD 2TB</td><td>2400</td><td>2</td><td>京东自营</td></tr><tr><td>三星 PM991 256GB + 佳翼硬盘盒</td><td>300</td><td>1</td><td>PM991闲鱼/硬盘盒京东</td></tr><tr><td>三星 850PRO SATA SSD 256G</td><td>0</td><td>2</td><td>家用闲置</td></tr><tr><td>Intel 傲腾 NVMe SSD 16GB</td><td>0</td><td>2</td><td>家用闲置</td></tr><tr><td>Intel 奔腾 G5420</td><td>-488</td><td>1</td><td>闲鱼出了</td></tr><tr><td>HPE 原装海力士 8GB ECC</td><td>-300</td><td>1</td><td>闲鱼出了</td></tr><tr><td>盈通 GTX1650 4GB DDR6</td><td>85</td><td>1</td><td>1535购入/1450出了</td></tr><tr><td>佳翼 NVMe 4X4 阵列卡</td><td>1200</td><td>1</td><td>淘宝</td></tr><tr><td>总计</td><td>15796</td><td></td><td></td></tr></tbody></table><p>之前没怎么认真统计花费，看到总计后还是惊了一下，老实说这个价格可以上塔式服务器或者洋垃圾DIY。选择Gen10 Plus的理由无外乎精致/美观/静音，毕竟这是一台可以放在卧室的服务器。</p><p>总的来说硬盘/存储占比重较大，当前情况下的配置不是最终配置，目的也仅仅是为了满足个人需求。</p><p>如果能把硬盘换成SATA SSD 4TB * 4会更好，当然NVMe阵列卡插满4条m.2也可，主做NAS服务器的话直接更换为10G/25G/40G网卡。配置是为了匹配实际用途，否则就是卑鄙的浪费。</p><h3 id=主机>主机<a hidden class=anchor aria-hidden=true href=#主机>#</a></h3><p>主机从下单到收货前前后后差不多一个月的时间。
<img loading=lazy src="https://pic.lvlv.fun/img/blog/Gen10P-5.jpg?x-oss-process=style/jpg" alt>
开箱，高贵的日耳曼甜美空气扑面而来(doge)。</p><p><img loading=lazy src="https://pic.lvlv.fun/img/blog/Gen10P-6.jpg?x-oss-process=style/jpg" alt>
即使在公司加班也阻止不了我欣赏它的美。</p><p><img loading=lazy src="https://pic.lvlv.fun/img/blog/Gen10P-7.jpg?x-oss-process=style/jpg" alt>
拧开快拆螺丝，欣赏大厂的工整做工，简直是一件艺术品。</p><h3 id=cpu>CPU<a hidden class=anchor aria-hidden=true href=#cpu>#</a></h3><p>首先我们要知道Gen10 Plus的DC电源是180W，在官方高配也就是Intel志强E-2224/16GB/单SSD的情况下整机功耗能达到110W，最多只能留下70W的可用空间。考虑到电源转换效率以及需要留点余量(20W)，这样我们可以操作的空间就只剩下50W。</p><p>每一块希捷 Exos X18 16TB的待机功耗大概是5W，满载功耗是10W，4块满载40W，这么看来光是硬盘塞满的情况下电源就已经快撑不住了，更别提上个网卡或显卡了。</p><p>然而事实是我们不会让服务器始终跑在100%的负载下，也就是说功耗峰值不代表日常功耗。根据我目前的配置，待机功耗在35W左右，目前跑了20+个服务的情况下也不过50W，程序的CPU占用率也可以在docker命令中加以限制。</p><p>现在我们再来看CPU的选择：</p><p><img loading=lazy src=https://www.servethehome.com/wp-content/uploads/2020/03/HPE-ProLiant-MicroServer-Gen10-Plus-CPU-Superset.jpg#center alt="HPE ProLiant MicroServer Gen10 Plus Ultimate Customization Guide"></p><blockquote><p>上图来自<a href=https://www.servethehome.com/>servethehome.com</a>的<a href=https://www.servethehome.com/hpe-proliant-microserver-gen10-plus-ultimate-customization-guide/1/>HPE ProLiant MicroServer Gen10 Plus Ultimate Customization Guide</a>一文，是一篇非常好的HPE Gen10 Plus设备选择指导。</p></blockquote><p>根据servethehome.com的测试结果，当使用E-2288G/64GB/单SSD在Windows Server 2019上跑Prime95时，功率计上的数值达到了194.5W，所以8核16线程直接排除。</p><p>由于跑大量服务需要更多的核心/线程数，并且官方高配就是4核4线程，所以我们筛选6核12线程的CPU如下：</p><table><thead><tr><th>型号</th><th>核心/线程数</th><th>频率</th><th>TDP(W)</th></tr></thead><tbody><tr><td>基准 E-2224</td><td>4C/4T</td><td>3.4-4.6GHz</td><td>71W</td></tr><tr><td>E-2276G</td><td>6C/12T</td><td>3.8-4.9GHz</td><td>80W</td></tr><tr><td>E-2246G</td><td>6C/12T</td><td>3.6-4.8GHz</td><td>80W</td></tr><tr><td>E-2236</td><td>6C/12T</td><td>3.4-4.8GHz</td><td>80W</td></tr><tr><td>E-2176G</td><td>6C/12T</td><td>3.7-4.7GHz</td><td>80W</td></tr><tr><td>E-2146G</td><td>6C/12T</td><td>3.5-4.5GHz</td><td>80W</td></tr><tr><td>E-2136</td><td>6C/12T</td><td>3.3-4.5GHz</td><td>80W</td></tr></tbody></table><p>最好的选择当然是E-2276G，但当时E-22XX系列太贵了，而且志强8代与9代性能差距不大，所以范围缩小成了E-2176G、E-2146G、E-2136三款。</p><p><img loading=lazy src="https://pic.lvlv.fun/img/blog/Intel-Xeon-E-2176G-vs-Intel-Xeon-E-2146G-vs-Intel-Xeon-E-2136.png?x-oss-process=style/jpg" alt></p><p>根据<a href=https://www.cpubenchmark.net/compare/Intel-Xeon-E-2176G-vs-Intel-Xeon-E-2146G-vs-Intel-Xeon-E-2136/3336vs3314vs3363>CPU Benchmarks</a>的对比结果来看三款在跑分上基本上可以说是没什么差距，由于E-2146G相比E-2136多了核显，虽然Gen10 Plus主板屏蔽了核显，但以后可以等E-2278G价格亲民后进行置换，拆下来E-2146G可以给别的机器用，所以最终选择了E-2146G。</p><p><img loading=lazy src="https://pic.lvlv.fun/img/blog/E2146G-1.jpg?x-oss-process=style/jpg" alt>
淘宝1400拿下E-2146G QS正显，步进和正式版相同e4，成色相当之好，插上点亮。</p><p><img loading=lazy src="https://pic.lvlv.fun/img/blog/iLO-3.png?x-oss-process=style/jpg" alt>
iLO中处理器信息一切正常。</p><p><img loading=lazy src="https://pic.lvlv.fun/img/blog/E2146G-2.jpg?x-oss-process=style/jpg" alt>
稍微测了下，睿频4.5GHz，全核心满载4.2GHz，此时CPU温度85度左右，插座显示120W，对这个结果相当满意。</p><h3 id=内存>内存<a hidden class=anchor aria-hidden=true href=#内存>#</a></h3><p>HPE Gen10 Plus官方产品页上写的最大支持内存是32GB，实测支持64GB，且不像Gen8，Gen10 Plus支持非ECC内存，给预算不充足的玩家留足了余地。</p><p>HPE的原装内存是海力士的8GB DDR4 ECC 2666MHz，在奔腾G5420下只能以2400MHz运行，不多说直接挂闲鱼。</p><p>32GB纯ECC内存的选择有三星和海力士。三星由于贴牌寨条较多，正品库存少不好买，海力士也是HPE认证内存厂商，所以选择了后者。</p><p><img loading=lazy src="https://pic.lvlv.fun/img/blog/iLO-4.png?x-oss-process=style/jpg" alt>
iLO内存信息，64GB DDR4 2666MHz ECC，双通道运行。</p><p><img loading=lazy src="https://pic.lvlv.fun/img/blog/iLO-5.png?x-oss-process=style/jpg" alt>
奇怪的是制造商一栏显示不适用，但其他信息完全正常，Reddit上查到只有官方部件号的16GB单条才有制造商信息，无所谓了。</p><p><em><strong>TODO&mldr;</strong></em></p><h3 id=pcie>PCIe<a hidden class=anchor aria-hidden=true href=#pcie>#</a></h3><h2 id=网络设备>网络设备<a hidden class=anchor aria-hidden=true href=#网络设备>#</a></h2><h3 id=openwrt>OpenWrt<a hidden class=anchor aria-hidden=true href=#openwrt>#</a></h3><h3 id=wi-fi-mesh>Wi-Fi Mesh<a hidden class=anchor aria-hidden=true href=#wi-fi-mesh>#</a></h3><h3 id=ups不间断电源>UPS不间断电源<a hidden class=anchor aria-hidden=true href=#ups不间断电源>#</a></h3><h2 id=其他>其他<a hidden class=anchor aria-hidden=true href=#其他>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.lvlv.fun/tags/homelab/>HomeLab</a></li><li><a href=https://blog.lvlv.fun/tags/%E8%AE%BE%E5%A4%87/>设备</a></li></ul><nav class=paginav><a class=next href=https://blog.lvlv.fun/posts/2019-10-29/><span class=title>下一页 »</span><br><span>MySQL/innoDB内部实现</span></a></nav></footer><div id=waline></div><script>Waline.init({el:"#waline",serverURL:"https://waline.lvlv.fun",dark:"auto",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.1/bilibili","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.1/weibo","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.1/tw-emoji"],meta:["nick","mail","link"],requiredMeta:["nick","mail"],login:"enable",wordLimit:"255",imageUploader:"false",locale:{admin:"MOD",placeholder:"麻瓜禁止留言"}})</script></article></main><footer class=footer><span>&copy; 2022 <a href=https://blog.lvlv.fun/>LvLv's Blog.</a></span>
<span>|</span>
<span>皖ICP备2022006072号-1</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="复制";function s(){e.innerText="已复制！",setTimeout(()=>{e.innerText="复制"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>