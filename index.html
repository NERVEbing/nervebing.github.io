<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>LvLv's Blog.</title><meta name=keywords content="Blog,Code,Technology,Network"><meta name=description content="LvLv's Blog."><meta name=author content="L"><link rel=canonical href=https://blog.lvlv.fun/><link crossorigin=anonymous href=/assets/css/stylesheet.min.45fdfa50104cd4e8762cefccb5ad33dd6cbaef5c109d72d25b1c27d6a21d00eb.css integrity="sha256-Rf36UBBM1Oh2LO/Mta0z3Wy671wQnXLSWxwn1qIdAOs=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.lvlv.fun/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.lvlv.fun/favicon16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.lvlv.fun/favicon32x32.png><link rel=apple-touch-icon href=https://blog.lvlv.fun/apple_touch_icon.png><link rel=mask-icon href=https://blog.lvlv.fun/apple_touch_icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://blog.lvlv.fun/index.xml><link rel=alternate type=application/json href=https://blog.lvlv.fun/index.json><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src=https://unpkg.com/@waline/client@v2/dist/waline.js></script>
<link rel=stylesheet href=https://unpkg.com/@waline/client@v2/dist/waline.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-PQC91FX0L3"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PQC91FX0L3",{anonymize_ip:!1})}</script><meta property="og:title" content="LvLv's Blog."><meta property="og:description" content="LvLv's Blog."><meta property="og:type" content="website"><meta property="og:url" content="https://blog.lvlv.fun/"><meta property="og:image" content="https://blog.lvlv.fun/apple_touch_icon.png"><meta property="og:site_name" content="LvLv's Blog."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.lvlv.fun/apple_touch_icon.png"><meta name=twitter:title content="LvLv's Blog."><meta name=twitter:description content="LvLv's Blog."><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"LvLv's Blog.","url":"https://blog.lvlv.fun/","description":"LvLv\u0026#39;s Blog.","thumbnailUrl":"https://blog.lvlv.fun/favicon.ico","sameAs":["https://github.com/NERVEbing","https://twitter.com/NERVEbing","https://facebook.com/nervebing","https://www.instagram.com/cliff.lyu","https://www.reddit.com/user/SenkoHanabi"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&(localStorage.clear(),document.body.classList.add("dark"))</script><header class=header><nav class=nav><div class=logo><a href=https://blog.lvlv.fun/ accesskey=h title="Home (Alt + H)"><img src=https://blog.lvlv.fun/apple-touch-icon.png alt=logo aria-label=logo height=35>Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://blog.lvlv.fun/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=https://blog.lvlv.fun/search/ title="æœç´¢ (Alt + /)" accesskey=/><span>æœç´¢</span></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>Hello there ğŸ‘‹</h1></header><div class=entry-content><p>ã€Œå›½å¢ƒã®é•·ã„ãƒˆãƒ³ãƒãƒ«ã‚’æŠœã‘ã‚‹ã¨é›ªå›½ã§ã‚ã£ãŸã€‚ã€</p></div><footer class=entry-footer><div class=social-icons><a href=https://github.com/NERVEbing target=_blank rel="noopener noreferrer me" title=Github><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://twitter.com/NERVEbing target=_blank rel="noopener noreferrer me" title=Twitter><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=https://facebook.com/nervebing target=_blank rel="noopener noreferrer me" title=Facebook><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></a><a href=https://www.instagram.com/cliff.lyu target=_blank rel="noopener noreferrer me" title=Instagram><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z"/><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/></svg></a><a href=https://www.reddit.com/user/SenkoHanabi target=_blank rel="noopener noreferrer me" title=Reddit><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1"><path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715.0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198.0 2.172-.97 2.172-2.163S21.396 2 20.199 2c-.92.0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249L11.755 7.82c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465.0-2.656 1.187-2.656 2.646.0.97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857C1.231 18.818 6.039 22 11.95 22s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zM6.776 13.595c0-.868.71-1.575 1.582-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179L12 19.44l-.013.003c-1.777.0-3.028-.386-3.824-1.179-.145-.144-.145-.379.0-.523.145-.145.381-.145.526.0.65.647 1.729.961 3.298.961l.013.003.013-.003c1.569.0 2.648-.315 3.298-.962.145-.145.381-.144.526.0.145.145.145.379.0.524zm-.189-3.095c-.872.0-1.581-.706-1.581-1.574s.709-1.575 1.581-1.575 1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"/></svg></a></div></footer></article><article class=post-entry><div class=post-info><header class=entry-header><h2>åŸºäºHPE MicroServer Gen10 Plusçš„HomeLabæ­å»º - ç¡¬ä»¶ç¯‡</h2></header><div class=entry-content><p>å‰è¨€ å£°æ˜ æœ¬æ–‡æ˜¯ä¸ªäººå¯¹HomeLabå³å®¶åº­ç§æœ‰å®éªŒå®¤çš„å­¦ä¹ æ¢ç´¢ï¼Œå‚æ‚ç€ä¸€äº›ç»éªŒæ€»ç»“ï¼Œè®°å½•ä¸‹æ¥ï¼Œä¹Ÿå¸Œæœ›å¯ä»¥è®©ä»–äººå°‘èµ°ä¸€äº›å¼¯è·¯ã€‚
HomeLabæ˜¯ä»€ä¹ˆï¼Ÿ æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿æ¥å„ç§è®¾å¤‡çš„å¤æ‚ç³»ç»Ÿï¼Œä½ å¯ä»¥ç”¨ä»»ä½•æ ‘è“æ´¾/PC/æœåŠ¡å™¨/è·¯ç”±å™¨ç»„æˆä¸€ä¸ªHomeLabã€‚
HomeLabæœ‰ä»€ä¹ˆç”¨ï¼Ÿ æ­å»ºå±äºç§äººçš„ç½‘ç›˜ï¼Œä¸å¿…åœ¨å„ä¸ªè®¾å¤‡ä¸Šå®‰è£…äº‘ç›˜appæ‰èƒ½ä¸Šä¼ /ä¸‹è½½æ–‡ä»¶ ä¸å—ç‰ˆæƒæ§åˆ¶çš„å®¶åº­å¤šåª’ä½“ï¼Œé›†æˆå½±è§†è®¢é˜…ï¼Œå®ç°è§‚å½±è¿½å‰§è‡ªç”± é›†æˆHomeBridgeä»¥å®ç°åœ¨iOS/macOSçš„Home.appä¸­æ“ä½œéHomeKitè®¤è¯çš„è®¾å¤‡ BTä¸‹è½½å™¨ï¼Œæ— éœ€å¼€å¯ä¸ªäººç”µè„‘ï¼Œåå°ä¸‹è½½èµ„æº RSSè®¢é˜…å™¨ï¼ŒæŠ›å¼ƒæ— æ„ä¹‰åœ°åˆ·æ‰‹æœºï¼Œåªè·å–è‡ªå·±æƒ³è¦çš„å†…å®¹ bilibiliæ¯æ—¥ä»»åŠ¡/JDäº¬è±†è·å–ï¼Œå„ç§è„šæœ¬åè–…èµ„æœ¬å®¶çš„ç¾Šæ¯› æœ€é‡è¦çš„æ˜¯ä½ å¯ä»¥æ­å»ºåŒ…æ‹¬ä½†ä¸é™äºK8S/ELK/MySQL/Redis/Prometheusç­‰å„ç§æœåŠ¡ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸Šé¢è·‘CI/CDè‡ªåŠ¨åŒ–æ„å»ºå‘å¸ƒä½ çš„ä»£ç  é˜…è¯»é—¨æ§› åŸºæœ¬çš„ç½‘ç»œçŸ¥è¯†ï¼Œæ¯”å¦‚å…‰çŒ«å’Œè·¯ç”±å™¨çš„åŒºåˆ«ï¼Œäº¤æ¢æœºæ˜¯å¹²ä»€ä¹ˆçš„ åŸºæœ¬çš„Linuxæ“ä½œï¼Œå¯ä»¥ç†è§£è®¡ç®—æœºä¸æ˜¯ä¸€å®šè¦è¿æ¥æ˜¾ç¤ºå™¨æ‰å¯ä»¥æ“ä½œ é‡åˆ°é—®é¢˜å…ˆä½¿ç”¨è‹±æ–‡è¿›è¡ŒGoogleï¼Œå†…å®¹è¿‡é•¿å¯ä»¥å¼€å¯é¡µé¢ç¿»è¯‘ï¼Œè¯·ä¸è¦çœ‹CSDNçš„å†…å®¹ ä¸æ±‚ç”šè§£ï¼Œå½“ä½ å‘ç°ä½ è®©å®ƒè·‘èµ·æ¥äº†çš„æ—¶å€™ï¼Œä¼šè·å¾—æå¤§çš„å¿ƒç†æ»¡è¶³æ„Ÿ è®¾å¤‡ æ¶æ„è¯´æ˜ ä¸»è¦åˆ†ä¸ºæœåŠ¡å™¨å’Œç½‘ç»œè®¾å¤‡ã€‚è€ƒè™‘åˆ°ç½‘ç»œè®¾å¤‡çš„ç¨³å®šæ€§åŠç½‘ç»œéš”ç¦»å¯¹æ•´å¥—ç³»ç»Ÿçš„é‡è¦ç¨‹åº¦ï¼Œæ²¡æœ‰é‡‡ç”¨è™šæ‹ŸåŒ–AIO(ALL IN ONE)æ–¹æ¡ˆã€‚
ä½œä¸ºæœåŠ¡ç«¯å¼€å‘è€…çœ‹æ¥æ‰€è°“çš„AIOæ¯«æ— ç¨³å®šæ€§å¯è¨€ï¼ŒESXiçš„OpenWrtè™šæ‹Ÿæœºå‡ºäº†æ•…éšœä¼šå½±å“å…¶ä»–ä¸šåŠ¡è™šæ‹Ÿæœºçš„è¿è¡Œï¼Œç”šè‡³è¿iLOåå°éƒ½è¿›ä¸å»ï¼Œéœ€è¦è¿æ¥æ˜¾ç¤ºå™¨æ‰‹åŠ¨é…ç½®ESXiè¿›è¡Œä¿®å¤ï¼Œè¿™ç§æƒ…å†µåœ¨å¼‚åœ°æ“ä½œHomeLabèŠ‚ç‚¹çš„æ—¶å€™æ˜¯æ¯ç­æ€§çš„ç¾éš¾ã€‚
å½“ç„¶è¿™ç§æ–¹å¼çš„å¥½å¤„ä¹Ÿæœ‰ï¼šç½‘ä¸Šæ•™ç¨‹å¤šï¼ŒæŒ‰è§†é¢‘æ“ä½œä¸€æ­¥æ­¥åšå‡ ä¹æ²¡æœ‰éš¾ç‚¹ï¼Œå°ç™½ä¹Ÿèƒ½è½»æ¾æ­å»ºã€‚
ç¼ºç‚¹å°±æ˜¯å¯¹æ•´ä½“çš„HomeLabç¯å¢ƒä¸€çŸ¥åŠè§£ç”šè‡³æ ¹æœ¬ä¸æ‡‚ï¼Œåªä¼šå¤åˆ¶ç²˜è´´ã€‚å½“ç„¶ä½ å¯ä»¥è¯´â€œæˆ‘åªæ˜¯æƒ³å¿«é€Ÿæ­å»ºä¸€æ•´å¥—æœåŠ¡ï¼Œä¸æƒ³äº†è§£ç»†èŠ‚â€ï¼Œè¿™æ ·çš„è¯æœ¬æ–‡å¯èƒ½ä¸é€‚åˆä½ ã€‚
æœåŠ¡å™¨ é¦–å…ˆæ˜¯æœ€é‡è¦çš„æœåŠ¡å™¨éƒ¨åˆ†ï¼Œç»å¤§å¤šæ•°è®¾å¤‡è´­å…¥æ—¶é—´ä¸º2021å¹´2-3æœˆï¼Œä»·æ ¼ç›¸æ¯”å½“å‰å¯èƒ½æœ‰å¾ˆå¤§å·®è·ï¼Œè´¹ç”¨æ¸…å•å¦‚ä¸‹ï¼š
è®¾å¤‡ ä»·æ ¼(å…ƒ) æ•°é‡ å¤‡æ³¨ HPE Gen10 Plus G5420/8GB 4000 1 æ·˜å®/å¾·å›½è½¬è¿ iLO5 NIC Kit 399 1 åŒä¸Š Intel å¿—å¼º E-2146G 1400 1 æ·˜å®/QSç‰ˆ æµ·åŠ›å£« 32GB DDR4 2666MHz ECC 2600 2 æ·˜å® å¸Œæ· Exos X18 16TB 4200 2 æ·˜å®/å›½è¡Œ è‹±ç¿è¾¾ MX500 SATA SSD 2TB 2400 2 äº¬ä¸œè‡ªè¥ ä¸‰æ˜Ÿ PM991 256GB + ä½³ç¿¼ç¡¬ç›˜ç›’ 300 1 PM991é—²é±¼/ç¡¬ç›˜ç›’äº¬ä¸œ ä¸‰æ˜Ÿ 850PRO SATA SSD 256G 0 2 å®¶ç”¨é—²ç½® Intel å‚²è…¾ NVMe SSD 16GB 0 2 å®¶ç”¨é—²ç½® Intel å¥”è…¾ G5420 -488 1 é—²é±¼å‡ºäº† HPE åŸè£…æµ·åŠ›å£« 8GB ECC -300 1 é—²é±¼å‡ºäº† ç›ˆé€š GTX1650 4GB DDR6 85 1 1535è´­å…¥/1450å‡ºäº† ä½³ç¿¼ NVMe 4X4 é˜µåˆ—å¡ 1200 1 æ·˜å® æ€»è®¡ 15796 ä¹‹å‰æ²¡æ€ä¹ˆè®¤çœŸç»Ÿè®¡èŠ±è´¹ï¼Œçœ‹åˆ°æ€»è®¡åè¿˜æ˜¯æƒŠäº†ä¸€ä¸‹ï¼Œè€å®è¯´è¿™ä¸ªä»·æ ¼å¯ä»¥ä¸Šå¡”å¼æœåŠ¡å™¨æˆ–è€…æ´‹åƒåœ¾DIYã€‚é€‰æ‹©Gen10 Plusçš„ç†ç”±æ— å¤–ä¹ç²¾è‡´/ç¾è§‚/é™éŸ³ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¸€å°å¯ä»¥æ”¾åœ¨å§å®¤çš„æœåŠ¡å™¨ã€‚...</p></div><footer class=entry-footer><span title="2022-05-08 11:09:36 +0800 +0800">2022-05-08</span>&nbsp;Â·&nbsp;2 åˆ†é’Ÿ&nbsp;Â·&nbsp;L</footer></div><figure class=entry-cover><img loading=lazy src="https://pic.lvlv.fun/img/blog/Gen10P-1.jpg?x-oss-process=style/jpg" alt></figure><a class=entry-link aria-label="post link to åŸºäºHPE MicroServer Gen10 Plusçš„HomeLabæ­å»º - ç¡¬ä»¶ç¯‡" href=https://blog.lvlv.fun/posts/2022-05-08/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>MySQL/innoDBå†…éƒ¨å®ç°</h2></header><div class=entry-content><p>MySQLå­˜å‚¨ç»“æ„ B-tree æ˜¯å¹³è¡¡çš„å¤šè·¯æŸ¥æ‰¾æ ‘ã€‚ æ¶‰åŠåˆ°ç£ç›˜çš„æŸ¥æ‰¾éœ€è¦è®¾æ³•å‡å°‘ç£ç›˜ I/O æ¬¡æ•°ã€‚ B-tree å°±æ˜¯ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜è€Œå¼•å…¥çš„æ•°æ®ç»“æ„ã€‚ åŒºåˆ«äºäºŒå‰æ ‘ b-tree å¯ä»¥æ‹¥æœ‰å¾ˆå¤šä¸ªå­èŠ‚ç‚¹ï¼ˆè¿™ä¸ªåº¦é‡è¢«ç§°ä¸ºã€Œå†…ç»“ç‚¹å‡ºåº¦ã€) æˆ‘ä»¬å¯ä»¥åœ¨æŠ€æœ¯ä¸Šä½¿ B-tree çš„ç»“ç‚¹å¤§å°ä¸ºç£ç›˜ä¸€ä¸ªé¡µçš„å¤§å°ï¼Œå¹¶ä¸”åœ¨æ–°å»ºç»“ç‚¹æ—¶ç›´æ¥ç”³è¯·ä¸€ä¸ªé¡µå¤§å°çš„ç©ºé—´ï¼Œä½¿å¾—ç»“ç‚¹çš„ç‰©ç†å­˜å‚¨ä½ç½®ä¹Ÿæ˜¯åœ¨ä¸€ä¸ªé¡µé‡Œï¼Œè¿™æ ·å°±èƒ½å®ç°å­˜å–ä¸€ä¸ªç»“ç‚¹åªéœ€ä¸€æ¬¡ç£ç›˜ I/O åœ¨æœ€åæƒ…å†µä¸‹ï¼ŒB-tree çš„ä¸€æ¬¡æ£€ç´¢æœ€å¤šéœ€è¦Hï¼ˆæ ‘çš„é«˜åº¦ï¼‰æ¬¡çš„ç£ç›˜ I/O å®é™…ä¸Šï¼Œä¸ºäº†å–å¾—æ›´å¤§çš„å†…ç»“ç‚¹å‡ºåº¦ï¼Œå„ä¸ªæ•°æ®åº“ä¸€èˆ¬ä¼šé‡‡ç”¨ B-treeçš„å˜ç§å¦‚ B+-treeï¼ŒB*-tree æ¥å®ç°ç´¢å¼•ï¼Œæ¯”å¦‚ MySQL çš„å­˜å‚¨å¼•æ“ InnoDB å°±é‡‡ç”¨ B+-tree æ¥å®ç°èšç°‡ç´¢å¼• ç´¢å¼• å­—ç¬¦ä¸²ç´¢å¼•ï¼Œé•¿åº¦é™åˆ¶ innodb å­˜å‚¨å¼•æ“ï¼Œé»˜è®¤å‰ç¼€é•¿åº¦æœ€å¤§èƒ½æ”¯æŒ767å­—èŠ‚ï¼›è€Œåœ¨å¼€å¯innodb_large_prefixå±æ€§å€¼çš„æƒ…å†µä¸‹ï¼Œæœ€å¤§èƒ½æ”¯æŒ3072å­—èŠ‚ å‰ç¼€ç´¢å¼•ï¼Œåç¼€ç´¢å¼•ï¼Œæ‰‹åŠ¨md5å“ˆå¸Œç´¢å¼• innodeå†…ç½®å“ˆå¸Œ Cardinality ä¸é‡å¤å€¼é¢„ä¼° ï¼Œé™¤ä»¥è®°å½•æ€»æ•°çš„æ¯”ä¾‹ å°½é‡æ¥è¿‘1 ç´¢å¼•çš„ä»·å€¼è¶Šå¤§ æŸ¥è¯¢ä¼˜åŒ–å™¨ é€‰æ‹©ç´¢å¼•æ—¶ä¼šè€ƒè™‘è¿™ä¸ªå€¼ oltp olap Online Analytical Processing Online transaction processing ç´¢å¼•ç»†èŠ‚ å•åˆ—ç´¢å¼•å¸å¤åˆç´¢å¼•åœ¨æ¯ä¸ªæ•°æ®é¡µå­˜çš„è®°å½•è¦å¤šï¼Œæ‰€ä»¥æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼˜å…ˆä½¿ç”¨å•åˆ—ç´¢å¼• è¦†ç›–ç´¢å¼• æ•°æ®æœ€å°è¯»å–å•ä½(ç´¢å¼•é¡µï¼Ÿ) count(*) æ“ä½œï¼Œå®é™…ä¼šè¯»å–è¾…åŠ©ç´¢å¼•ï¼Œé¿å…è¯»å–èšåˆç´¢å¼• ç»Ÿè®¡æ“ä½œï¼Œè¦†ç›–ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥æŸ¥è¯¢å¤åˆç´¢å¼•(a,b) ä¸­çš„b index hint ç´¢å¼•æç¤º use index åªæ˜¯æç¤ºï¼Œforce indexæ‰æ˜¯å¼ºåˆ¶ multi-range read ä¼˜åŒ– ä»è¾…åŠ©ç´¢å¼•ç­›é€‰å®Œä¹‹åï¼Œå°†ç»“æœï¼Œå·²ä¸»é”®è¿›è¡Œæ’åºï¼Œå†å»è¯»èšåˆç´¢å¼•ä¸‹çš„è®°å½•è¡Œ index condition pushdown ï¼ˆIPCï¼‰ä¼˜åŒ–ï¼Œå°†where è¿‡æ»¤æ¡ä»¶æ¨é€åˆ°å­˜å‚¨å¼•æ“ï¼Œå‡å°‘æ•°æ®ä¼ è¾“ (ä½¿ç”¨æ—¶ä¼šæç¤º using index condition) innodb å…¨æ–‡ç´¢å¼• ä½¿ç”¨å€’æ’ç´¢å¼•å®ç° ï¼Œä½¿ç”¨äº†FTS Index Cache ç¼“å­˜æ•°æ®å˜æ›´ï¼Œæ‰¹é‡æ›´æ–°åˆ°Auxiliary Tableä¸­(è¿™ä¸ªè¡¨å¯ä»¥é€šè¿‡å…³é”®è¯å®šä½åˆ°æ–‡æ¡£ï¼Œå•è¯ä½ç½®) é” myisam åªæ”¯æŒè¡¨é”ï¼Œsql server 2005ç‰ˆä¹‹å‰åªæ”¯æŒé¡µé”ï¼Œ2005å¼€å§‹æ”¯æŒè¡Œé”ï¼Œä½†æ˜¯å®ç°æ–¹å¼ä¸innodbä¸åŒï¼ŒåŠ é”ä¼šæœ‰èµ„æºå¼€é”€ï¼Œinnodbåˆ™ä¸oracle çš„é”å®ç°ç±»ä¼¼...</p></div><footer class=entry-footer><span title="2019-10-29 19:12:30 +0800 +0800">2019-10-29</span>&nbsp;Â·&nbsp;3 åˆ†é’Ÿ&nbsp;Â·&nbsp;L</footer></div><a class=entry-link aria-label="post link to MySQL/innoDBå†…éƒ¨å®ç°" href=https://blog.lvlv.fun/posts/2019-10-29/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>gRPC Connection reset by peer é—®é¢˜</h2></header><div class=entry-content><p>å‰æ å› äº§å“éœ€æ±‚ï¼Œéœ€ç”¨PHPï¼ˆv7.0.12ï¼‰è°ƒç”¨k8sé›†ç¾¤ä¸­gRPCï¼ˆgolang@1.12.0ï¼‰æœåŠ¡ã€‚
é—®é¢˜ ç»è¿‡devç¯å¢ƒæµ‹è¯•ï¼Œå½“php-fpmå¯åŠ¨åç¬¬ä¸€æ¬¡è°ƒç”¨æˆ–è€…è·ç¦»ä¸Šæ¬¡è°ƒç”¨æ—¶é—´20åˆ†é’Ÿåå·¦å³ï¼Œå†æ¬¡è¯·æ±‚gRPCå¾®æœåŠ¡æ¥å£ï¼Œå°±ä¼šè¿”å› Connection reset by peer é”™è¯¯ï¼Œè¯´æ˜gRPCæœåŠ¡ç«¯æˆ–è€…å®¢æˆ·ç«¯ä¸»åŠ¨å…³é—­è¿æ¥äº†ã€‚ç»§ç»­å‘èµ·è¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼Œåˆæ¢å¤æ­£å¸¸ã€‚
æ€è€ƒ ç»æŸ¥é˜…ç›¸å…³èµ„æ–™ï¼Œå‘ç°é—®é¢˜å¯èƒ½å‡ºç°åœ¨k8sé›†ç¾¤çš„kube-proxyæ¨¡å¼ä¸Šã€‚å½“å‰k8sç¯å¢ƒ(dev)ä¸‹çš„kube-proxyä¸ºipvsæ¨¡å¼ï¼ŒæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¹‹é—´é€šä¿¡å¦‚ä¸‹ï¼š
æŠŠä¸Šå›¾clientçœ‹æˆæ˜¯apsopen-insideæœåŠ¡podï¼ŒBackend pod(1~3)çœ‹æˆgRPCæœåŠ¡ï¼Œå¯ä»¥çœ‹å‡ºå®ƒä»¬ä¹‹é—´çš„äº¤äº’è·¯å¾„ï¼š
1 2 3 ---> gRPC server pod1 gRPC-client ---> ipvs ---> gRPC server pod3 ---> gRPC server pod3 æˆ‘ä»¬çŸ¥é“gRPCæ˜¯åŸºäºHTTP/2åè®®çš„ï¼ŒgRPCçš„clientå’Œserveråœ¨äº¤äº’æ—¶ä¼šå»ºç«‹å¤šæ¡è¿æ¥ï¼Œä¸ºäº†æ€§èƒ½ï¼Œè¿™äº›è¿æ¥éƒ½æ˜¯é•¿è¿æ¥å¹¶ä¸”æ˜¯ä¸€ç›´ä¿æ´»çš„ã€‚ è¿™æ®µç¯å¢ƒä¸­ä¸ç®¡æ˜¯å®¢æˆ·ç«¯æœåŠ¡è¿˜æ˜¯gRPCæœåŠ¡éƒ½è¢«è°ƒåº¦åˆ°å„ä¸ªç›¸åŒé…ç½®ä¿¡æ¯çš„KubernetesèŠ‚ç‚¹ä¸Šï¼Œè¿™äº›k8sèŠ‚ç‚¹çš„ keep-alive æ˜¯ä¸€è‡´çš„ï¼Œå¦‚æœå‡ºç°è¿æ¥ä¸»åŠ¨å…³é—­çš„é—®é¢˜ï¼Œå› ä¸ºä»clientåˆ°serverç»å†äº†ä¸€å±‚ipvsï¼Œæ‰€ä»¥æœ€å¤§çš„å¯èƒ½å°±æ˜¯ipvså‡ºå°†è¿æ¥ä¸»åŠ¨æ–­å¼€ï¼Œè€Œclientç«¯è¿˜ä¸çŸ¥æƒ…ã€‚ æœç´¢ ipvs timeout å…³é”®å­—æ‰¾åˆ°äº†ä¸‹é¢ç›¸å…³çš„é“¾æ¥ï¼š
https://github.com/moby/moby/issues/31208 https://success.docker.com/article/ipvs-connection-timeout-issue https://github.com/kubernetes/kubernetes/issues/32457 å…¶ä¸­ https://github.com/moby/moby/issues/31208 ä¸­æ˜¯å…³äºdocker swarmåœ¨overlayç½‘ç»œä¸‹é•¿è¿æ¥çš„é—®é¢˜ï¼Œè¿™ä¸ªå’Œk8s kube-proxyåº”è¯¥æ˜¯ç±»ä¼¼çš„ï¼ŒæŒ‰ç…§è¿™ä¸ªé“¾æ¥ä¸­çš„æè¿°æŸ¥çœ‹ æˆ‘ä»¬è¿™å¥—ç¯å¢ƒå…³äºtcp keepaliveçš„å†…æ ¸å‚æ•°ï¼š
1 2 3 4 5 6 #è¿›å…¥igo-util-shorturiå®¹å™¨ sysctl net.ipv4.tcp_keepalive_time net.ipv4.tcp_keepalive_probes net.ipv4.tcp_keepalive_intvl net.ipv4.tcp_keepalive_time = 7200 net....</p></div><footer class=entry-footer><span title="2019-07-22 12:40:20 +0800 +0800">2019-07-22</span>&nbsp;Â·&nbsp;1 åˆ†é’Ÿ&nbsp;Â·&nbsp;L</footer></div><a class=entry-link aria-label="post link to gRPC Connection reset by peer é—®é¢˜" href=https://blog.lvlv.fun/posts/2019-07-22/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>gRPC error code</h2></header><div class=entry-content><p>RPC.response.status.code HTTP RPC Description 0 - OK 200 OK Not an error; returned on success. 1 - CANCELLED 499 Client Closed Request The operation was cancelled, typically by the caller. 2 - UNKNOWN 500 Internal Server Error Unknown error. For example, this error may be returned when a Status value received from another address space belongs to an error space that is not known in this address space....</p></div><footer class=entry-footer><span title="2019-06-12 20:04:20 +0800 +0800">2019-06-12</span>&nbsp;Â·&nbsp;4 åˆ†é’Ÿ&nbsp;Â·&nbsp;L</footer></div><a class=entry-link aria-label="post link to gRPC error code" href=https://blog.lvlv.fun/posts/2019-06-12/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>Protobufæ€»ç»“</h2></header><div class=entry-content><p>Protobufæ˜¯ä»€ä¹ˆ Protobufæ˜¯ä¸€ç§å¹³å°æ— å…³ã€è¯­è¨€æ— å…³ã€å¯æ‰©å±•ä¸”è½»ä¾¿é«˜æ•ˆçš„åºåˆ—åŒ–æ•°æ®ç»“æ„çš„åè®®ï¼Œå¯ä»¥ç”¨äºé€šä¿¡åè®®å’Œæ•°æ®å­˜å‚¨ç­‰ã€‚ ä¼ è¾“åè®®Â -Â å¦‚jsonã€XML IDLÂ -Â æ¥å£æè¿°è¯­è¨€ å­˜å‚¨æ ¼å¼Â -Â åºåˆ—åŒ–å‹ç¼©åå­˜å‚¨åˆ°æ•°æ®åº“ æ ¸å¿ƒç«äº‰åŠ› å‘å‰å‘åå…¼å®¹æ€§Â -Â æ–°è€ç‰ˆæœ¬å…¼å®¹ï¼Œæ— éœ€è€ƒè™‘ç‰ˆæœ¬å‡çº§ å¤šè¯­è¨€ä»£ç ç”ŸæˆÂ -Â æ”¯æŒJavaã€Pythonã€PHPã€Goç­‰ç¼–ç¨‹è¯­è¨€ å¿«&å°Â -Â åºåˆ—åŒ–ã€ååºåˆ—åŒ–é€Ÿåº¦å¿«ï¼Œå‹ç¼©æ¯”ä¼˜ç§€ å…³é”®æŠ€æœ¯ varintsç¼–ç  æ¯ä¸ªå­—èŠ‚ä½¿ç”¨å…¶ä¸­7ä½ä¿å­˜æ•°å­—ï¼Œæœ€é«˜ä½è¡¨ç¤ºåé¢æ˜¯å¦è¿˜æœ‰å†…å®¹ ä½ä½åœ¨å‰ï¼Œé«˜ä½åœ¨å ä¿ç•™äº†fixed32å’Œfixed64ï¼Œç”¨äºä¼ é€’å¤§çš„æ­£æ•° int32ã€int64ã€unit32ã€uint64ã€boolï¼Œåºåˆ—åŒ–ç»“æœç›¸äº’å…¼å®¹ï¼Œå¯ä»¥ä¿®æ”¹ zigzagç¼–ç  ä¼ ç»Ÿä¸Šï¼Œè´Ÿæ•°æœ€é«˜ä½ä¸º1ï¼Œå°è´Ÿæ•°ä¼šæµªè´¹ç¼–ç é•¿åº¦ (n&lt;&lt;1)^(n>>31) -1å°†ä¼šè¢«ç¼–ç æˆ1ï¼Œ1å°†ä¼šç¼–ç æˆ2ï¼Œ-2å°†ä¼šè¢«ç¼–ç æˆ3 sint32å’Œsint64ä½¿ç”¨zigzagç¼–ç  message structureç¼–ç  Tag-Valueç¼–ç  Tag=(field_number&lt;&lt;3)|wire_type->varints wire_type:0è¡¨ç¤ºvarintsï¼Œ1è¡¨ç¤ºå›ºå®š64ä½ï¼Œ5è¡¨ç¤ºå›ºå®š32ä½ wire_type:2è¡¨ç¤ºTag-Length-Valueç¼–ç ï¼ˆTLVï¼‰ï¼ŒLengthä½¿ç”¨varints stringã€bytesã€messageåµŒå¥—ï¼Œéƒ½é‡‡ç”¨TLVç¼–ç  wire_typeåªæœ‰0ã€1ã€2ã€5ï¼Œé‚£ä¹ˆ3å’Œ4å»å“ªäº†ï¼Ÿâ€”è¢«åºŸé™¤äº†
repeatedç¼–ç  ç¬¬ä¸€ç§æ–¹å¼ï¼šé‡å¤å‡ºç°çš„ç›¸åŒtag
ç¬¬äºŒç§æ–¹å¼ï¼š(packed=true)ï¼ŒTLVVVâ€¦ç¼–ç 
ä»…æœ‰æ•°å­—ç±»å‹æ‰å¯ä»¥ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼Œprotocol buffers 3ï¼ˆpb3ï¼‰ä¸­é»˜è®¤ç¬¬äºŒç§ï¼Œpb2ä¸­éœ€è¦æŒ‡å®šï¼Œç¬¬ä¸€ç§ä»»ä½•æƒ…å†µä¸‹ä¼šè¢«æ”¯æŒ
érepeatedæƒ…å†µå‡ºç°é‡å¤tagï¼Œåé¢çš„è¦†ç›–å‰é¢çš„ï¼Œå› æ­¤optionalå’Œrepeatedç›¸äº’å…¼å®¹
Mapç¼–ç  map&lt;key_type,value_type>map_field=N
åºåˆ—åŒ–ç»“æœå®Œå…¨ç­‰ä»·äºï¼š...</p></div><footer class=entry-footer><span title="2019-03-14 11:18:20 +0800 +0800">2019-03-14</span>&nbsp;Â·&nbsp;1 åˆ†é’Ÿ&nbsp;Â·&nbsp;L</footer></div><a class=entry-link aria-label="post link to Protobufæ€»ç»“" href=https://blog.lvlv.fun/posts/2019-03-14/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://blog.lvlv.fun/page/2/>ä¸‹ä¸€é¡µ Â»</a></nav></footer></main><footer class=footer><span>&copy; 2022 <a href=https://blog.lvlv.fun/>LvLv's Blog.</a></span>
<span>|</span>
<span>çš–ICPå¤‡2022006072å·-1</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>